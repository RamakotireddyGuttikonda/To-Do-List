-------------------------Add To Git---------------------------
git init
git add .
git remote add origin <githublink>.git
git commit -m "Initial commit"
git push -u origin main


====================How to pull from dockerhub and run ==============
1. Pull Image
docker pull redis

2. Redis Container
docker run --name my-redis -d redis

3. Enter into Redis CLI
docker exec -it my-redis redis-cli

Run Test Commands :
	SET name "Alice"
	GET name
	exit

4. Stop Container
docker stop my-redis

5.Restart Container
docker start my-redis

6. Delete Container
docker rm my-redis

7. Delete Image
docker rmi redis

--------------Use a Dockerfile (Create Your OwnImage)----------------------

mkdir Redis
cd Redis

-> create Dockerfile
FROM redis:latest
CMD ["redis-server"]

Build Image
docker build -t redisnew .

Run Image
docker run --name myredisnew -d redisnew

Stop Container
docker stop myredisnew


---------------Push Image to Docker Hub------------------------------------
docker login
docker commit <container-id> username/redis1
docker push username/redis1

Delete :
docker rm <container-id>
docker rmi username/redis1

docker logout

--------Create Custom Image and Container (Basics)- if asked ---------
mkdir myapp
cd myapp

Dockerfile:
FROM nginx

docker build -t myimage .
docker run --name mycontainer -d myimage

docker stop mycontainer
docker rm mycontainer


----------- Docker Compose -------------------------------------------
mkdir compose-lab
cd compose-lab


docker-compose.yml:
version: "3.9"

services:
  web:
    image: nginx:latest
    ports:
      - "8080:80"

  db:
    image: postgres:15
    environment:
      POSTGRES_USER: demo
      POSTGRES_PASSWORD: demo
      POSTGRES_DB: demo_db


docker compose up -d
http://localhost:8080


---------------- Add Redis service ------------------------
version: "3.9"

services:
  redis:
    image: redis:alpine
  web:
    image: nginx:latest
    ports:
      - "8080:80"
    depends_on:
      - redis

  db:
    image: postgres:15
    environment:
      POSTGRES_USER: demo
      POSTGRES_PASSWORD: demo
      POSTGRES_DB: demo_db

docker compose up -d
docker compose ps

========================= Run Flask App with Compose=============
app.py :

from flask import Flask
app = Flask(__name__)

@app.route("/")
def home():
    return "Hello from Flask + Docker!"

app.run(host="0.0.0.0", port=5000)

Dockerfile:

FROM python:3.10-slim
WORKDIR /app
COPY app.py /app/
RUN pip install flask
CMD ["python", "app.py"]

docker-compose.yml :

version: "3.9"

services:

  web:
    build: .
    ports:
      - "5000:5000"
    depends_on:
      - db

  db:
    image: postgres:15
    environment:
      POSTGRES_USER: demo
      POSTGRES_PASSWORD: demo
      POSTGRES_DB: demo_db
    volumes:
      - db-data:/var/lib/postgresql/data

volumes:
  db-data:

========================== Minikube ===========================

minikube start --driver=docker
kubectl create deployment nginx --image=nginx:alpine
kubectl expose deployment nginx --type=NodePort --port=80 --target-port=80
kubectl scale deployment nginx --replicas=4
minikube get service nginx 

http://localhost:8081

Delete :
kubectl delete deployment mynginx
kubectl delete service mynginx

-----------------------------------------------------------------


kubectl create deployment mysql --image=mysql:8
kubectl set env deployment/mysql MYSQL_ROOT_PASSWORD=root
kubectl expose deployment mysql --port=3306
kubectl get pods
kubectl exec -it <pod-name> -- mysql -u root -proot



docker compose up --build

http://localhost:5000

======================= AWS ===================================
Click on Launch Instance

 
Stage 1  --Name (Giving name to the machine) ubuntu 
       Stage 2  -- Select AMI  ( Note: Select free tier eligible ) ubuntu server
Give name and select ubuntu under application
 
Select this free tier option of Ubuntu from here
 
Stage 3   --  Architecture as 64-bit	
Make sure AMI and Architecture are there as shown
 
Stage 4  --  Instance type ----  t2.micro(default 1 CPU,1 GB RAM)
 
 
Stage 5  --  Create a new keypair---a keypair will downloaded  with extension .pem
                              Store key in folder AWS
First Click on create-new key pair
 

Give KeyPair name and click on create key pair
 

Save the .pem file in folder AWS on desktop 
 
Stage 6  -- Network Setting ----Create Security group  --  ( It deals with ports )
(Note for understanding We have 0 to 65535 ports. Every port is dedicated to special purpose)		
HERE select https and http (which allow to load your web pages while execution)
In network setting check all the checkboxes 
 

Stage 7 -- Storage - 8GB ( Observation - we have root - it is same as C Drive) it default 8 GB

Stage 8 --- click on launch instance

Now click on the instances

 
Wait for the Success message to apper in green color
  
You can see MyExampleWebServer is Running and wait for it to initialize

 
You have to get 2 tests passes. 
Important:---- Now check the box and click on connect.
Do this step:---once it is created select that instance 
(Tick in checkbox) and click on connect
 

Thus your EC2 instance is running on server. 
 
Step 4: Now you can connect local system to server (EC2 instance) using secure shell SSH.

 
For this, Here copy the ssh – i command from SSH client connect tab and paste later
Next We can use powershell /gitbash /webconsole in administrative mode, to connect to ubuntu machine.
Step a: Copy the path of .pem file that you saved earlier in folder AWS eg.  as here D:\SUNNY\SELABWEB\AWS
  
 
Step b: Open Powershell in administrative mode and navigate to that path. 
Type:   cd < path> 
eg. cd D:\SUNNY\SELABWEB\AWS here specify your .pem path

 

Step c: Go to SSh and copy the command ssh which is present at the below

 
Note: To connect to above terminals we need to go into the path of the keypair.and 
paste  the   ssh -i command from the aws console
 
Step d: Run the pasted ssh -i command in the terminal

 

Step 5: Run the following commands to install s/w
1.	Update all softwares in Ubuntu by command
sudo apt update

 

2.	Install docker by command
sudo apt-get install docker.io
 

3.	Install git by command
sudo apt install git

 

4.	Install nano( text editor) by command
Sudo apt install nano

 

Step 6: Now we want to create an application, push it into git, create docker image of it and run it

Step a: Create basic index.html file in folder Example and save it

 

Step b: Open git Bash in folder Example by right clicking with mouse

 

Step c: In git bash run the following commands
git init
git add .
Git commit –m “first commit”
 

 
Step d: Create git repository (here with name AWS)
 

Step e: Copy command one by one from above repository and run as below
git branch –M main
git remote add origin <https url>
git push –u origin main

 

 
Step f:  refresh repository and You can now see index.html in github
 

Step g:  Copy http path
 

Step h:  Clone the repository with copied http path by command in command prompt         git clone <copied http url>
Step i:  Navigate to the cloned folder. Type cd AWS as below, next ls to 
 
Step j:  create Dockerfile in above command prompt in ububtu ie in power shell
        Nano Dockerfile
 

Step k:  Write the following data in Dockerfile and click ctrl+o  Enter and then ctrl-x
 

Step L:  Build docker image by executing the following command
                sudo docker build –t mywebapp .

 
Thus image is created
Step m:  run the image and map it to port 80 
  sudo docker run –d –p 80:80 mywebapp

 

Step n:  Go to instances and click on instance here

 

Step o:  Copy public ipv4 address

 
 
Step p:  Paste it in the browser to get below output
Note : if https :__ won’t work then type just http:___
 

Important   do it without fail.    Step Q:  stop container 

Run the following command to stop the container
i.	sudo docker ps
ii.	sudo docker stop <container-id>

 
iii.	Go back to instances and click on option instance. Once load as below, then Click on Instance state and select terminate instances
 
Click on Terminated (deleted)
 

iv.	Now click on End lab
 

End of exercise 1 (DEPLOYMENT of index.html using EC2 instance in AWS) consisting of:
1.	creating EC2 instance to install Ubuntu, docker, git , and nano. 
2.	creating web application (index.html) using Visual studio
3.	Pushing index.html to github and cloning the it
4.	Creating Dockerfile to build image for running index.html on nginx server  
5.	Run it as container using docker command and get the output on browser
6.	Terminate the instance 
7.	 End lab

2 MAVEN WEB PROJECT DEPLOYMENT IN AWS

Click on start lab
 

Click on AWS
 

Click on EC2
 
Click on launch instance
 
Give name
 

Create new key
 

Check all the boxes under network and click  on launch instance
 

Click on instances
 

Wait until you get 2 tests passes
 

Click on connect after checking the box
 

Copy ssh command
 

Open the terminal, Navigate to the path 
 

Run the ssh command
 
Run the following commands
 
 
 
 

Open MAVEN WEB PROJECT REPO in github and copy http link
 

Clone the repository
 

If your repository is in main run following
 

If not goto your github repo 
Click on settings
Under default branch section click on the icon shown and you’re your master branch as default and execute above commands
 

 

 

Build docker image
 

Run the container

 

Copy public ipv4
 

Enter this url in browser and click enter
 

If your app is not running goto security  and Click on security groups

 
          


      Click on edit inbound rules

 

Click on add rule give port as 9090 and 0.0.0.0/0 click on save
 

And refresh the page to check whether the web page has loaded or not
 

If it is loaded you have successfully deployed you maven web project In your ec2 instance


Run the following commands to stop the container 

Terminate your instance
 

End your lab

============================== Jenkins============================================

pipeline {
    agent any
    tools{
        jdk 'JAVA_HOME'
        maven 'Maven-3.9.11'
    }
    stages {
        stage('git repo & clean') {
            steps {
                bat "rmdir /s /q E-ticketing || exit 0"
                bat "git clone https://github.com/gnavneet41/E-ticketing.git"
                bat "mvn clean -f E-ticketing/pom.xml"
            }
        }
        stage('install') {
            steps {
                bat "mvn install -f E-ticketing/pom.xml" 
            }
        }
        stage('test') {
            steps {
                bat "mvn test -f E-ticketing/pom.xml"
            }
        }
        stage('package') {
            steps {
                bat "mvn package -f E-ticketing/pom.xml"
            }
        }
    }
}

II. Maven Web Automation Steps:
└── Step 1: Open Jenkins (localhost:8080)
    ├── Click on "New Item" (left side menu)
     
    └── Step 2: Create Freestyle Project (e.g., MavenWeb_Build)
        ├── Enter project name (e.g., MavenWeb_Build)
        ├── Click "OK"
 
        └── Configure the project:
            ├── Description: "Web Build demo"
            ├── Source Code Management:
            		└── Git repository URL: [GitMavenWeb repo URL]
            ├── Branches to build: */Main or master
 
            └── Build Steps:
                ├── Add Build Step -> "Invoke top-level Maven targets"
                	└── Maven version: MAVEN_HOME
                	 └── Goals: clean
                ├── Add Build Step -> "Invoke top-level Maven targets"
                	└── Maven version: MAVEN_HOME
                	└── Goals: install
 
                └── Post-build Actions:
                    ├── Add Post Build Action -> "Archive the artifacts"
                   	 └── Files to archive: **/*
                    ├── Add Post Build Action -> "Build other projects"
                    	└── Projects to build: MavenWeb_Test
                    	└── Trigger: Only if build is stable
                    └── Apply and Save
 

    └── Step 3: Create Freestyle Project (e.g., MavenWeb_Test)
        ├── Enter project name (e.g., MavenWeb_Test)
        ├── Click "OK"
 
        └── Configure the project:
            ├── Description: "Test demo"
            ├── Build Environment:
            		└── Check: "Delete the workspace before build starts"
            ├── Add Build Step -> "Copy artifacts from another project"
            		└── Project name: MavenWeb_Build
            		└── Build: Stable build only
            		└── Artifacts to copy: **/*
 
            ├── Add Build Step -> "Invoke top-level Maven targets"
           		└── Maven version: MAVEN_HOME
            		└── Goals: test
            └── Post-build Actions:
                ├── Add Post Build Action -> "Archive the artifacts"
                	└── Files to archive: **/*
 
                ├── Add Post Build Action -> "Build other projects"
                	└── Projects to build: MavenWeb_Deploy
                └── Apply and Save
 
    └── Step 4: Create Freestyle Project (e.g., MavenWeb_Deploy)
        ├── Enter project name (e.g., MavenWeb_Deploy)
        ├── Click "OK"
 
        └── Configure the project:
            ├── Description: "Web Code Deployment"
            ├── Build Environment:
            		└── Check: "Delete the workspace before build starts"
            ├── Add Build Step -> "Copy artifacts from another project"
            		└── Project name: MavenWeb_Test
            		└── Build: Stable build only
               	└── Artifacts to copy: **/*
 
            └── Post-build Actions:
                ├── Add Post Build Action -> "Deploy WAR/EAR to a container"
   └── WAR/EAR File: **/*.war
   └── Context path: Webpath
 └── Add container -> Tomcat 9.x remote
└── Credentials: Username: admin, Password: 1234
── Tomcat URL: https://localhost:8085/
                └── Apply and Save
 

    └── Step 5: Create Pipeline View for MavenWeb
        ├── Click "+" beside "All" on the dashboard
        ├── Enter name: MavenWeb_Pipeline
        ├── Select "Build pipeline view"
 

        └── Pipeline Flow:
            ├── Layout: Based on upstream/downstream relationship
            ├── Initial job: MavenWeb_Build
            └── Apply and Save
 

    └── Step 6: Run the Pipeline and Check Output
        ├── Click on the trigger “RUN” to run the pipeline
 
            Note: 
1.	After Click on Run -> click on the small black box to open the console to check if the build is success
2.	Now we see all the build has  success if it appears in green color
 o
        ├── Open Tomcat homepage in another tab
        ├── Click on the "/webpath" option under the manager app
               Note:
1.	 It ask for user credentials for login ,provide the credentials of tomcat.
2.	It provide the page with out project name which is highlighted.
3.	After clicking on our project we can see output.



--------------------------------------------------------------------------------------------------

Setting Up  Jenkins CI------using GitHub Webhook with Jenkins 

Step 1: Configure Webhook in GitHub
1.	Go to your GitHub repository.
2.	Navigate to Settings → Webhooks.
3.	Click “Add webhook”.
4.	In the Payload URL field:
o	Enter the Jenkins webhook URL in the format:
http://<jenkins-server-url>/github-webhook/
Note: If Jenkins is running on localhost, GitHub cannot access it directly.
Use ngrok to expose your local Jenkins to the internet:

o	ngrok.exe http <Jenkins local host:8080>
	Use the generated ngrok URL, e.g.:
	https://wintry-gloryingly-nam.ngrok-free.dev /github-webhook/
5.	Set Content type to:
application/json
6.	Under “Which events would you like to trigger this webhook?”, select:
o	 Just the push event
7.	Click “Add webhook” to save.
________________________________________
 Step 2: Configure Jenkins to Accept GitHub Webhooks
1.	Open Jenkins Dashboard.
2.	Select the job (freestyle or pipeline) you’ve already created.
3.	Click Configure.
4.	Scroll down to the Build Triggers section.
5.	Check the box: ✅GitHub hook trigger for GITScm polling
6.	Click Save.
________________________________________
 Step 3: Test the Setup
1.	Make any code update in your local repo and push it to GitHub.
2.	Once pushed, GitHub will trigger the webhook.
3.	Jenkins will automatically detect the change and start the build pipeline.
________________________________________
outcome
•	You’ve successfully connected GitHub and Jenkins using webhooks.
•	Every time you push code to GitHub, Jenkins will automatically start building your project without manual intervention.

Set-uping the ngrok

How to Install and Use ngrok

Step 1. Download ngrok
https://ngrok.com/download
Download and extract it for your OS (Windows, macOS, or Linux).

Step 2. Connect Your ngrok Account (optional but useful)
After you sign up (free), ngrok gives you an auth token.
•	Then got to  Your Authtoken  click here and copy
•	Go ngrok 	command promt
CREATE AUTHENTICATOR [https://dashboard.ngrok.com/get-started/your-authtoken]
Run this command (replace <your_token> with yours):
ngrok config add-authtoken <your_token>
This ensures stable sessions and more control.

Step 3. Start a Tunnel for Jenkins

Assuming Jenkins runs locally on port 8080:
Now Go ngrok 	command prompt and type below commad
ngrok http 8080
You’ll see output like:

Session Status                online
Forwarding                   https://wintry-gloryingly-nam.ngrok-free.dev -> http://localhost:8080
Copy the HTTPS URL (https://wintry-gloryingly-nam.ngrok-free.dev) — this is your public Jenkins URL for webhooks.
Step 4. Use it in GitHub Webhook

In your GitHub repo → Settings → Webhooks:
•	Payload URL: 		 [paste the url generated by ngrok]

https://wintry-gloryingly-nam.ngrok-free.dev /github-webhook/    [please include this – remaining all default]
Now, whenever you push code, GitHub sends an event to that URL, which ngrok forwards to your local Jenkins.

------------------------------------------------------------------------------------------------------------------------------------

============================================== Multi Module =====================================================================


Creating a Multi-Module Maven Project:
1.	Open eclipse-> file-> new -> other -> Maven -> MavenProject ->click on next.
2.	Check the first option: Create a Simple project(skip archetype selection) and click on next.
3.	Give groupID: KMIT, artifact ID: MultiModule, in the packaging tab select the drop down and opt for pom.
4.	Give Name: Multimodule creation and Description: Sample multimodule with parent child hierarchy and click on next.
5.	Now the Multimodule folder is created and displayed in the project explorer on the left. Right click on the folder and opt new -> mavenModule
6.	Check the option Create a Simple project(skip archetype selection, give the artifactID: MultiModuleChild1 and click on next and finish.
7.	Now you can see, the module1 we created is displayed in the project explorer with a separate pom.xml file.
8.	Right click on the MultiModule folder in the project explorer and opt new -> mavenModule
9.	Give the artifactID: MultiModuleChild2 and click on next.
10.	In filters search for maven-archetype-webapp, select the version 1.1/1.5 and click on next.
11.	Now click on finish, and confirm with a Y in the console.
12.	Now you can watch the new child is been added to the parent project.
Note: Childs or Modules can be added to the projects who have the packaging type as pom. If we try to create a module within child1 it is not possible since its packaging is opted to JAR.
Linking two modules in a Parent Project:
Go to the module u want to connect. And add a dependency to other module on which the current module depends. For example if my child2 is dependent on child1. I have to change the dependencies in the pom.xml by adding a new dependency of child1.
Steps to add dependency:
1.	Goto pom.xml of child2.
2.	Navigate to dependencies tag. Update the dependencies with child1 dependency as given below, and save pom.xml after update.
<dependency>
		<groupId>KMIT</groupId>
			<artifactId>MultimoduleChild1</artifactId>
			<version>0.0.1-SNAPSHOT</version>
	</dependency>


3.	Now build the child2 by right clicking it and opting run as->maven build.
4.	The build will be a failure. Because we haven’t build the parent project and the child project. Child1 is dependent on parent. And Child2 is dependent on child2. SO we have to build ass the previous module first and then build the current child2.
5.	After building parent and child1, build child2 now the build will be a Success

